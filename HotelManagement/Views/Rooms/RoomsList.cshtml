@using Microsoft.AspNetCore.Mvc.Localization
@using HotelManagement.Models;
@using HotelManagement.ViewModels;
@inject IViewLocalizer Localizer
@model RoomsListViewModel
<!-- Rooms List View -->
<!-- This view displays a list of all rooms in a hotel. -->
<!-- Managers can create new rooms and delete existing ones. -->
@{
	ViewData["Title"] = Localizer["RoomsList"];
}

<h3>@Localizer["RoomsList"]</h3>

<div class="container">
	<div class="row row-cols-1 row-cols-md-3 g-4">

		<!-- Inline Card for Creating New Room -->
		@if(User.IsInRole("Manager"))
		{
			<div class="col">
				<div class="card h-100 border-success shadow-sm">
					<div class="card-body">
						<h5 class="card-title text-success">@Localizer["CreateNewRoom"]</h5>
						<form asp-action="Create" method="post">
							<div class="mb-2">
								<label for="RoomNumber" class="form-label">@Localizer["RoomNumber"]</label>
								<input type="text" name="RoomNumber" class="form-control" required />
							</div>
							<div class="mb-2">
								<label for="Description" class="form-label">@Localizer["RoomDesc"]</label>
								<textarea name="Description" class="form-control" rows="2"></textarea>
							</div>
							<div class="mb-3">
								<label for="RoomTypeId" class="form-label">@Localizer["RoomType"]</label>
								<select name="RoomTypeId" class="form-select" required>
									<option value="">-- @Localizer["SelectType"] --</option>
									@foreach (var type in Model.RoomTypes)
									{
										<option value="@type.Id">@type.Name (@type.Capacity @Localizer["Guests"])</option>
									}
								</select>
							</div>
							<button type="submit" class="btn btn-success w-100">@Localizer["AddRoom"]</button>
						</form>
					</div>
				</div>
			</div>
		}

		@foreach (var room in Model.Rooms)
		{
			var roomTypeName = room.RoomType?.Name ?? "";
			var roomTypeDescription = room.RoomType?.Description ?? "";
			var roomCapacity = room.RoomType?.Capacity ?? 0;

			<div class="col">
				<div class="card h-100 shadow-sm">
					<div class="card-body">
						<h5 class="card-title">@Localizer["Room"] @room.RoomNumber</h5>
						<p class="card-text">@room.Description</p>

						<hr />
						<p><strong>@Localizer["Type"]:</strong> @roomTypeName</p>
						<p><strong>@Localizer["Description"]:</strong> @roomTypeDescription</p>
						<p><strong>@Localizer["Capacity"]:</strong> @roomCapacity @Localizer["Guests"]</p>
					</div>
					<div class="card-footer bg-transparent border-top-0">
						<div class="d-flex justify-content-between gap-2">
							<a asp-action="RoomDetails" asp-route-id="@room.Id" class="btn btn-primary w-100">@Localizer["ViewDetails"]</a>

							@if (User.IsInRole("Manager"))
							{
								<form asp-action="Delete" asp-route-id="@room.Id" method="post"
									  onsubmit="return confirm(@Localizer["DeleteRoomText"]);" class="w-100">
									<button type="submit" class="btn btn-danger w-100">@Localizer["DeleteRoom"]</button>
								</form>
							}
						</div>
					</div>
				</div>
			</div>
		}
	</div>

</div>
