@model HotelManagement.Models.Room
<!-- Room Details View -->
<!-- This view displays the details of a room, including its bookings in a calendar. -->
@{
	ViewData["Title"] = "Room Details";
}

<div class="container mt-4">
	<div class="card shadow-sm">
		<div class="card-body">
			<h3 class="card-title">Room @Model.RoomNumber</h3>
			<p class="card-text"><strong>Description:</strong> @Model.Description</p>

			@if (Model.Bookings?.Any() == true)
			{
				<h5 class="mt-4">Bookings:</h5>
				<ul class="list-group">
					@foreach (var booking in Model.Bookings)
					{
						<li class="list-group-item">
							<strong>Guest:</strong> @booking.ApplicationUserId
							| <strong>From:</strong> @booking.StartDate.ToShortDateString()
							| <strong>To:</strong> @booking.EndDate.ToShortDateString()
						</li>
					}
				</ul>
			}
			else
			{
				<p class="text-muted mt-4">No bookings for this room yet.</p>
			}

			<!-- Calendar -->
			<div id="calendar" class="mt-4"></div>

			<a asp-action="RoomsList" class="btn btn-secondary mt-4">Back to List</a>
			<script>
				const bookings = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(
						Model.Bookings.Select(b => new
						{
							title = "Booked",
							start = b.StartDate.ToString("yyyy-MM-dd"),
							end = b.EndDate.AddDays(1).ToString("yyyy-MM-dd")
						})
					));
			</script>

			<!-- Initialize FullCalendar -->
			<script>
				document.addEventListener('DOMContentLoaded', function () {
					var calendarEl = document.getElementById('calendar');

					var calendar = new FullCalendar.Calendar(calendarEl, {
						initialView: 'dayGridMonth',
						height: 'auto',
						events: bookings,
						eventColor: '#dc3545',
						selectable: true
					});

					calendar.render();
				});
			</script>
		</div>
	</div>
</div>

